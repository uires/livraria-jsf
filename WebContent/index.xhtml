<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
	<title>Home - Livros</title>
</h:head>
	<h:body>
		<p:layout >
		    <p:layoutUnit position="west" resizable="false" size="245" minSize="245" maxSize="245">
			    <p:menu>
			        <p:submenu label="Ações">
			        	<p:menuitem value="Home"  url="/" />
			            <p:menuitem value="Cadastrar Autor" url="/cadastro/cadastroautor.xhtml" />
			        </p:submenu>
			    </p:menu>
		    </p:layoutUnit>
		    <p:layoutUnit position="center">
				<p:dataTable id="tabela-livros" var="iten" value="#{livroMB.livros}" style="margin-bottom:10px" 
						paginator="true" rows="10">
			        Tabela Livros
					<p:column headerText="Id" sortBy="#{iten.id}">
						<h:outputText value="#{iten.id}" />
					</p:column>
			
					<p:column headerText="Título" sortBy="#{iten.titulo}">
						<h:outputText value="#{iten.titulo}" />
					</p:column>
			
					<p:column headerText="Data">
						<h:outputText value="#{iten.dataLancamento.time}" >
							<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
						</h:outputText>
					</p:column>
					
					<p:column headerText="ISBN">
						<h:outputText value="#{iten.isbn}" />
					</p:column>
			
					<p:column headerText="Preço" sortBy="#{iten.preco}">
						<h:outputText value="R$ #{iten.preco}" />
					</p:column>
					
				</p:dataTable>
				<p:commandButton value="Cadastrar Livro" type="button" onclick="PF('modalCadastroLivro').show();" />
				<p:dialog header="Cadastro Livro" widgetVar="modalCadastroLivro" modal="true" height="300" width="750" 
						position="center" appendTo="@(body)">
    				<h:form>
						<h:panelGrid columns="2">
							<p:outputLabel for="titulo" value="Título: " />
							<p:inputText id="titulo" value="#{livroMB.livro.titulo}" required="true" 
									requiredMessage="Campo obrigatório" >
								<f:validateLength maximum="155" minimum="10" />
							</p:inputText>
				
							<h:outputText for="isbn" value="ISBN " />
            				<p:inputMask id="isbn" value="#{livroMB.livro.isbn}" mask="999-9-99-999999-9" />
				
							<p:outputLabel for="preco" value="Preço: " />
							<p:inputText id="preco" value="#{livroMB.livro.preco}" />
				
							<p:outputLabel for="data" value="Data Lancamento: " />
							<p:inputMask id="data" value="#{livroMB.livro.dataLancamento}" mask="99/99/9999" >
								<!-- <f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/> -->
							</p:inputMask>
							<h:form>
								<p:outputLabel value="Autor: " />
								<p:selectOneMenu value="#{livroMB.autorId}">
									<f:selectItems value="#{livroMB.autores}" var="autor"
										itemLabel="#{autor.nome}" itemValue="#{autor.id}" />
								</p:selectOneMenu>
								<p:commandButton action="#{livroMB.gravarAutor}" value="Gravar" />
							</h:form>
							<h:dataTable var="autor" value="#{livroMB.livro.autores}">
								<h:column>
									<h:outputText value="#{autor.nome}"/>
								</h:column>
							</h:dataTable>
							<p:commandButton action="#{livroMB.cadastrarLivro()}" value="Cadastrar" 
									onclick="PF('modalCadastroLivro').hide();"/>
						</h:panelGrid>
					</h:form>
				</p:dialog>   
			</p:layoutUnit>
		</p:layout>
	</h:body>
</html>